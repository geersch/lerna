<!DOCTYPE html><html lang="en-US"><head><title>Monorepos</title><meta property="og:title" content="Monorepos"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTBMMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMzIgOTBsNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDBsMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwbDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwMS01LTVWMjBhNSA1IDAgMDE1LTVoNjBhNSA1IDAgMDE1IDV2NU0zMCA4NWg2MCIvPjxyZWN0IHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIi8+PHJlY3QgY2xhc3M9ImEiIHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNNDAgNTBoNDBNNDAgNjBoMzAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;z-index:-1;pointer-events:none;opacity:0}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;z-index:0;pointer-events:auto;opacity:1}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{-webkit-animation-name:__bespoke_marp__!important;animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;z-index:1;will-change:transform}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{flex:0 0 0;background:#0288d1;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{font-family:Helvetica,Arial,sans-serif;height:100%;left:0;position:absolute;top:0;width:100%;display:grid;grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;grid-template-areas:"current next" "current note" "info    note"}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;position:relative;overflow:hidden}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:20px;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{margin:20px;width:calc(100% - 40px);height:calc(100% - 40px);box-sizing:border-box;font-size:1.1em;overflow:auto;padding-right:3px;white-space:pre-wrap;word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,93.3%,.5) transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,93.3%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{display:block;box-sizing:border-box;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>@charset "UTF-8";@import url("https://fonts.googleapis.com/css?family=Lato:400,900|Roboto+Mono:400,700&display=swap");div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}
/*!
 * Marp / Marpit Gaia theme.
 *
 * @theme gaia
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section .hljs{display:block;overflow-x:auto;padding:.5em;background:#000;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-quote{color:#aeaeae;font-style:italic}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#e28964}div#p>svg>foreignObject>section .hljs-string{color:#65b042}div#p>svg>foreignObject>section .hljs-subst{color:#daefa3}div#p>svg>foreignObject>section .hljs-link,div#p>svg>foreignObject>section .hljs-regexp{color:#e9c062}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section,div#p>svg>foreignObject>section .hljs-tag,div#p>svg>foreignObject>section .hljs-title{color:#89bdff}div#p>svg>foreignObject>section .hljs-class .hljs-title,div#p>svg>foreignObject>section .hljs-doctag{text-decoration:underline}div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-number,div#p>svg>foreignObject>section .hljs-symbol{color:#3387cc}div#p>svg>foreignObject>section .hljs-params,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#3e87e3}div#p>svg>foreignObject>section .hljs-attribute{color:#cda869}div#p>svg>foreignObject>section .hljs-meta{color:#8996a8}div#p>svg>foreignObject>section .hljs-formula{background-color:#0e2231;color:#f8f8f8;font-style:italic}div#p>svg>foreignObject>section .hljs-addition{background-color:#253b22;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-deletion{background-color:#420e09;color:#f8f8f8}div#p>svg>foreignObject>section .hljs-selector-class{color:#9b703f}div#p>svg>foreignObject>section .hljs-selector-id{color:#8b98ab}div#p>svg>foreignObject>section .hljs-emphasis{font-style:italic}div#p>svg>foreignObject>section .hljs-strong{font-weight:700}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:580px}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin:.5em 0 0}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{font-weight:inherit}div#p>svg>foreignObject>section h1{font-size:1.8em}div#p>svg>foreignObject>section h2{font-size:1.5em}div#p>svg>foreignObject>section h3{font-size:1.3em}div#p>svg>foreignObject>section h4{font-size:1.1em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section p{margin:1em 0 0}div#p>svg>foreignObject>section ol>li,div#p>svg>foreignObject>section ul>li{margin:.3em 0 0}div#p>svg>foreignObject>section ol>li>p,div#p>svg>foreignObject>section ul>li>p{margin:.6em 0 0}div#p>svg>foreignObject>section code{display:inline-block;font-family:Roboto Mono,monospace;font-size:.8em;letter-spacing:0;margin:-.1em .15em;padding:.1em .2em;vertical-align:baseline}div#p>svg>foreignObject>section pre{display:block;margin:1em 0 0;min-height:1em;overflow:visible}div#p>svg>foreignObject>section pre code{box-sizing:border-box;margin:0;min-width:100%;padding:.5em;font-size:.7em}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:calc(580px - 1em)}div#p>svg>foreignObject>section blockquote{margin:1em 0 0;padding:0 1em;position:relative}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before{content:"“";display:block;font-family:Times New Roman,serif;font-weight:700;position:absolute}div#p>svg>foreignObject>section blockquote:before{top:0;left:0}div#p>svg>foreignObject>section blockquote:after{right:0;bottom:0;transform:rotate(180deg)}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section mark{background:transparent}div#p>svg>foreignObject>section table{border-spacing:0;border-collapse:collapse;margin:1em 0 0}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{padding:.2em .4em;border-width:1px;border-style:solid}div#p>svg>foreignObject>section{background-image:linear-gradient(135deg,hsla(0,0%,53.3%,0),hsla(0,0%,53.3%,.02) 50%,hsla(0,0%,100%,0) 0,hsla(0,0%,100%,.05));font-size:35px;font-family:Lato,Avenir Next,Avenir,Trebuchet MS,Segoe UI,sans-serif;height:720px;line-height:1.35;letter-spacing:1.25px;padding:70px;width:1280px;word-wrap:break-word;color:#455a64;background-color:#fff8e1}div#p>svg>foreignObject>section{--marpit-root-font-size:35px}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section a,div#p>svg>foreignObject>section mark{color:#0288d1}div#p>svg>foreignObject>section code{background:#6a7a7d;color:#fff8e1}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{color:#0288d1}div#p>svg>foreignObject>section pre>code{background:#455a64}div#p>svg>foreignObject>section blockquote:after,div#p>svg>foreignObject>section blockquote:before,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header,div#p>svg>foreignObject>section section:after{color:#6a7a7d}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{border-color:#455a64}div#p>svg>foreignObject>section table thead th{background:#455a64;color:#fff8e1}div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section table tbody>tr:nth-child(odd) th{background:rgba(69,90,100,.1)}div#p>svg>foreignObject>section.invert{color:#fff8e1;background-color:#455a64}div#p>svg>foreignObject>section.invert a,div#p>svg>foreignObject>section.invert mark{color:#81d4fa}div#p>svg>foreignObject>section.invert code{background:#dad8c8;color:#455a64}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#81d4fa}div#p>svg>foreignObject>section.invert pre>code{background:#fff8e1}div#p>svg>foreignObject>section.invert blockquote:after,div#p>svg>foreignObject>section.invert blockquote:before,div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header,div#p>svg>foreignObject>section.invert section:after{color:#dad8c8}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#fff8e1}div#p>svg>foreignObject>section.invert table thead th{background:#fff8e1;color:#455a64}div#p>svg>foreignObject>section.invert table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section.invert table tbody>tr:nth-child(odd) th{background:rgba(255,248,225,.1)}div#p>svg>foreignObject>section.gaia{color:#fff8e1;background-color:#0288d1}div#p>svg>foreignObject>section.gaia a,div#p>svg>foreignObject>section.gaia mark{color:#81d4fa}div#p>svg>foreignObject>section.gaia code{background:#cce2de;color:#0288d1}div#p>svg>foreignObject>section.gaia h1 strong,div#p>svg>foreignObject>section.gaia h2 strong,div#p>svg>foreignObject>section.gaia h3 strong,div#p>svg>foreignObject>section.gaia h4 strong,div#p>svg>foreignObject>section.gaia h5 strong,div#p>svg>foreignObject>section.gaia h6 strong{color:#81d4fa}div#p>svg>foreignObject>section.gaia pre>code{background:#fff8e1}div#p>svg>foreignObject>section.gaia blockquote:after,div#p>svg>foreignObject>section.gaia blockquote:before,div#p>svg>foreignObject>section.gaia footer,div#p>svg>foreignObject>section.gaia header,div#p>svg>foreignObject>section.gaia section:after{color:#cce2de}div#p>svg>foreignObject>section.gaia table td,div#p>svg>foreignObject>section.gaia table th{border-color:#fff8e1}div#p>svg>foreignObject>section.gaia table thead th{background:#fff8e1;color:#0288d1}div#p>svg>foreignObject>section.gaia table tbody>tr:nth-child(odd) td,div#p>svg>foreignObject>section.gaia table tbody>tr:nth-child(odd) th{background:rgba(255,248,225,.1)}div#p>svg>foreignObject>section.lead{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center}div#p>svg>foreignObject>section.lead h1,div#p>svg>foreignObject>section.lead h2,div#p>svg>foreignObject>section.lead h3,div#p>svg>foreignObject>section.lead h4,div#p>svg>foreignObject>section.lead h5,div#p>svg>foreignObject>section.lead h6{text-align:center}div#p>svg>foreignObject>section.lead h1 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h2 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h3 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h4 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h5 svg[data-marp-fitting=svg],div#p>svg>foreignObject>section.lead h6 svg[data-marp-fitting=svg]{--preserve-aspect-ratio:xMidYMid meet}div#p>svg>foreignObject>section.lead p{text-align:center}div#p>svg>foreignObject>section.lead blockquote>h1,div#p>svg>foreignObject>section.lead blockquote>h2,div#p>svg>foreignObject>section.lead blockquote>h3,div#p>svg>foreignObject>section.lead blockquote>h4,div#p>svg>foreignObject>section.lead blockquote>h5,div#p>svg>foreignObject>section.lead blockquote>h6,div#p>svg>foreignObject>section.lead blockquote>p{text-align:left}div#p>svg>foreignObject>section.lead blockquote svg[data-marp-fitting=svg]:not([data-marp-fitting-math]){--preserve-aspect-ratio:xMinYMin meet}div#p>svg>foreignObject>section.lead ol>li>p,div#p>svg>foreignObject>section.lead ul>li>p{text-align:left}div#p>svg>foreignObject>section.lead table{margin-left:auto;margin-right:auto}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{box-sizing:border-box;font-size:66%;height:70px;line-height:50px;overflow:hidden;padding:10px 25px;position:absolute}div#p>svg>foreignObject>section:after{--marpit-root-font-size:66%}div#p>svg>foreignObject>section header{top:0}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{left:0;right:0}div#p>svg>foreignObject>section footer{bottom:0}div#p>svg>foreignObject>section:after{right:0;bottom:0;font-size:80%}div#p>svg>foreignObject>section:after{--marpit-root-font-size:80%}div#p>svg>foreignObject>section{font-size:large}div#p>svg>foreignObject>section{--marpit-root-font-size:large}div#p>svg>foreignObject>section footer{text-align:right}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-class="lead invert" data-theme="gaia" class="lead invert" style="--class:lead invert;--theme:gaia;">
<h1>Monorepos</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-class="invert" data-theme="gaia" class="invert" style="--class:invert;--theme:gaia;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;lernaean-hydra.png&quot;);background-size:50%;"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="2" data-class="invert" data-theme="gaia" class="invert" style="--class:invert;--theme:gaia;" data-marpit-advanced-background="content"></section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section class="invert" style="" data-marpit-advanced-background="pseudo"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-marpit-fragments="9" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h1>Agenda</h1>
<ul>
<li data-marpit-fragment="1">Lerna</li>
<li data-marpit-fragment="2">What does a monorepo look like?</li>
<li data-marpit-fragment="3">Lerna Commands</li>
<li data-marpit-fragment="4">Lerna with NPM</li>
<li data-marpit-fragment="5">Lerna with Yarn</li>
<li data-marpit-fragment="6">Yarn Workspaces</li>
<li data-marpit-fragment="7">Lerna with Yarn Workspaces</li>
<li data-marpit-fragment="8">GitHub Packages</li>
<li data-marpit-fragment="9">Continuous Deployment</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-marpit-fragments="5" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Lerna</h2>
<ul>
<li data-marpit-fragment="1">
<p>Splitting up large codebases into separate independently versioned packages is useful for code sharing.</p>
</li>
<li data-marpit-fragment="2">
<p>Tracking changes and testing accross repositories becomes difficult very quickly.</p>
</li>
<li data-marpit-fragment="3">
<p>Organize your codebases into multi-package repositories also known as monorepos.</p>
</li>
<li data-marpit-fragment="4">
<p>Examples: <a href="https://github.com/angular/angular">Angular</a>, <a href="https://github.com/facebook/jest">Jest</a>, <a href="https://github.com/facebook/react">React</a>...</p>
</li>
<li data-marpit-fragment="5">
<p>Lerna helps you optimize to manage multi-package repositories !</p>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>What does a monorepo look like?</h2>
<pre><code class="language-plaintext"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>./my-monorepo
│
│  README.md
│  package.json
│
-───packages
    │
    -────package-1
    │   │  README.md
    │   │  package.json
    │   │   ...
    -────package-2
    │   │  README.md
    │   │  package.json
    │   │   ...
    -────package-3
        │  README.md
        │  package.json
        │   ...
</span></span></foreignObject></svg></code></pre>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-marpit-fragments="9" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Lerna Commands</h2>
<ul>
<li data-marpit-fragment="1">lerna init</li>
<li data-marpit-fragment="2">lerna bootstrap</li>
<li data-marpit-fragment="3">lerna run</li>
<li data-marpit-fragment="4">lerna exec</li>
<li data-marpit-fragment="5">lerna add</li>
<li data-marpit-fragment="6">lerna version</li>
<li data-marpit-fragment="7">lerna publish</li>
<li data-marpit-fragment="8">lerna clean</li>
<li data-marpit-fragment="9">lerna info</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-marpit-fragments="4" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna init</h3>
<p>Install Lerna for access to the CLI. Creates a new Lerna repo or upgrades an existing repo to the current version of Lerna</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna init</span>
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">
<p>Lerna will be added as a <code>devDependency</code> in <code>package.json</code>.</p>
</li>
<li data-marpit-fragment="2">
<p>Creates a <code>lerna.json</code> config file to store the version number.</p>
</li>
<li data-marpit-fragment="3">
<p>By default Lerna projects operate on a single line version. The version is kept in the <code>lerna.json</code> file at the root of your project under the <code>version</code> key.</p>
</li>
<li data-marpit-fragment="4">
<p>Independent mode allows you to increment package versions independently of each other. Each time you publish, you will get a prompt for each package that has changed to specify if it's a patch, minor or major change.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">#</span><span class="bash"> Independent mode</span>
<span class="hljs-meta">$</span><span class="bash"> lerna init --independent</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-marpit-fragments="5" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna bootstrap</h3>
<p>Bootstraps the packages in the current repo.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna bootstrap</span>
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">
<p>Installs all of the dependencies and links any cross-dependencies. It will symlink together all packages that are dependencies of each other.</p>
</li>
<li data-marpit-fragment="2">
<p>Runs the <code>prepublish</code> and <code>prepare</code> scripts in all bootstrapped packages.</p>
</li>
<li data-marpit-fragment="3">
<p>The <code>prepublish</code> script is <a href="https://docs.npmjs.com/misc/scripts">deprecated</a> and has been replaced with the <code>prepare</code> script. The NPM CLI runs the <code>prepublish</code> script for both <code>npm publish</code> and <code>npm install</code>.</p>
</li>
<li data-marpit-fragment="4">
<p>Use <code>prepublishOnly</code> script to only run a script before <code>npm publish</code>.</p>
</li>
<li data-marpit-fragment="5">
<p>Use the <code>--hoist</code> flag to install dependencies at the repo root. Binaries from these dependencies are linked into the dependent package <code>node_modules/.bin</code> directory.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna bootstrap [glob]</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-marpit-fragments="3" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna run</h3>
<p>Run a script in each package that contains that script.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna run &lt;script&gt; -- [..args]</span>
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">
<p>For example, running the unit tests for each package.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna run <span class="hljs-built_in">test</span></span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Stream the output from the child processes immediately, prefixed with the package name.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna run <span class="hljs-built_in">test</span> --stream</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="3">
<p>Can also be run in parallel.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna run <span class="hljs-built_in">test</span> --stream --parallel</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-marpit-fragments="3" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna exec</h3>
<p>Run a command in each package.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna <span class="hljs-built_in">exec</span> -- &lt;<span class="hljs-built_in">command</span>&gt; [...args]</span>
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">
<p>For example, for cleaning each package folder.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna <span class="hljs-built_in">exec</span> -- rm -rf ./coverage ./dist ./node_modules junit.xml </span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Scoped packages are supported.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna <span class="hljs-built_in">exec</span> --scope @geersch/logging -- rm -rf  ./node_modules</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="3">
<p>Can also be run in parallel.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna <span class="hljs-built_in">exec</span> --parallel -- rm -rf  ./node_modules</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-marpit-fragments="2" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna add</h3>
<p>Add a package as a dependency to packages in the current repo.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna add &lt;package&gt;[@version] [--dev] [--exact] [--peer]</span>
</span></span></foreignObject></svg></code></pre>
<p>For example:</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna add lodash</span>
<span class="hljs-meta">$</span><span class="bash"> lerna add lodash --scope @geersch/logging</span>
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">
<p>Adding a development dependency.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna add debug --dev</span>
<span class="hljs-meta">$</span><span class="bash"> lerna add debug --dev --scope @geersch/logging</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Adding a peer dependency.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna add lodash --peer</span>
<span class="hljs-meta">$</span><span class="bash"> lerna add lodash --peer --scope @geersch/logging</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-marpit-fragments="3" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna version</h3>
<p>Identifies the packages that have been updated and will prompt for a new version.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna version</span>
</span></span></foreignObject></svg></code></pre>
<p>By default it commits the changes, tags the commit and pushes to the remote.</p>
<ul>
<li data-marpit-fragment="1">
<p>Use <code>--no-git-tag-version</code> if you don't want it to create a commit.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna version --no-git-tag-version</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>You can also pass a semver level and the <code>--yes</code> flag to skip the selection prompt</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna version [major | minor | patch | premajor | preminor | prepatch | ...] --yes</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="3">
<p>If you use the <code>--conventional-commits</code> flag, then it will use the <a href="https://www.conventionalcommits.org/en/v1.0.0/">Conventional Commits specification</a> to determine the version bump and generate <code>CHANGELOG.md</code> files.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna version --conventional-commits</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-marpit-fragments="2" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna publish</h3>
<p>Identifies the packages have been updated and publishes them.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna publish</span>
</span></span></foreignObject></svg></code></pre>
<p>Calls <code>lerna version</code> and publishes the packages updated since the last release.</p>
<ul>
<li data-marpit-fragment="1">
<p>Use <code>from-git</code> to publish packages tagged in the current commit.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna publish from-git</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Use <code>from-package</code> to inspect each <code>package.json</code> file and publish if the package version is not present in the registry. Handy if a previous <code>lerna publish</code> failed to publish all the packages.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna publish from-package</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-marpit-fragments="2" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna clean</h3>
<p>Remove the <code>node_modules</code> directory from all packages.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna clean</span>
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">
<p>I prefer <code>lerna exec</code> to clean each package folder.</p>
<p>Just put the following <code>purge</code> script in the <code>package.json</code> file at the root of your project.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;purge&quot;</span>: <span class="hljs-string">&quot;lerna exec --parallel -- rm -rf ./node_modules ./coverage ./dist junit.xml&quot;</span>
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Or use <code>lerna run</code> and provide a script per package.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna run clean</span>
<span class="hljs-meta">$</span><span class="bash"> lerna run --scope @geersch/logging clean</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Lerna info</h3>
<p>Prints local environment information that can be useful for submitting bug reports.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> lerna info</span>
</span></span></foreignObject></svg></code></pre>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>Environment info:

System:
  OS: macOS 10.15.6
  CPU: (12) x64 Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz
Binaries:
  Node: 12.16.1 - ~/.nvm/versions/node/v12.16.1/bin/node
  Yarn: 1.22.5 - ~/.nvm/versions/node/v12.16.1/bin/yarn
  npm: 6.14.8 - ~/.nvm/versions/node/v12.16.1/bin/npm
Utilities:
  Git: 2.24.3 - /usr/bin/git
npmPackages:
  lerna: ^3.22.1 =&gt; 3.22.1
</span></span></foreignObject></svg></code></pre>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-footer="Monorepos - Christophe Geers" data-class="lead invert" data-theme="gaia" class="lead invert" style="--footer:Monorepos - Christophe Geers;--class:lead invert;--theme:gaia;">
<h2>Lerna with NPM</h2>
<h2>git clone <a href="https://github.com/geersch/lerna.git">https://github.com/geersch/lerna.git</a></h2>
<p>git checkout master</p>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Lerna with NPM</h2>
<h3>Installation</h3>
<p>By default Lerna uses <a href="https://www.npmjs.com/">NPM</a> as the client to run commands with.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> mkdir lerna</span>
<span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> lerna</span>
<span class="hljs-meta">$</span><span class="bash"> npx lerna init</span>
<span class="hljs-meta">$</span><span class="bash"> npm install</span>
</span></span></foreignObject></svg></code></pre>
<h3>lerna.json</h3>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;packages&quot;</span>: [
    <span class="hljs-string">&quot;packages/*&quot;</span>
  ],
  <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;independent&quot;</span>,
  <span class="hljs-attr">&quot;command&quot;</span>: {
    <span class="hljs-attr">&quot;publish&quot;</span>: {
      <span class="hljs-attr">&quot;registry&quot;</span>: <span class="hljs-string">&quot;https://npm.pkg.github.com&quot;</span>
    }
  }
}
</span></span></foreignObject></svg></code></pre>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>package.json</h3>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;root&quot;</span>,
  <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;A monorepo example using Lerna.&quot;</span>,
  <span class="hljs-attr">&quot;private&quot;</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">&quot;scripts&quot;</span>: {
    <span class="hljs-attr">&quot;postinstall&quot;</span>: <span class="hljs-string">&quot;lerna bootstrap&quot;</span>,
  },
  <span class="hljs-attr">&quot;devDependencies&quot;</span>: { ... }
}
</span></span></foreignObject></svg></code></pre>
<p>After installing the packages (<code>npm install</code>) the <code>postinstall</code> script will run <code>lerna bootstrap</code> which bootstraps the packages in the current Lerna repo. It will symlink together all Lerna <code>packages</code> that are dependencies of each other</p>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-marpit-fragments="3" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h3>Hoisting</h3>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;root&quot;</span>,
  <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;A monorepo example using Lerna.&quot;</span>,
  <span class="hljs-attr">&quot;private&quot;</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">&quot;scripts&quot;</span>: {
    <span class="hljs-attr">&quot;postinstall&quot;</span>: <span class="hljs-string">&quot;lerna bootstrap --hoist&quot;</span>,
  },
  <span class="hljs-attr">&quot;devDependencies&quot;</span>: { ... }
}
</span></span></foreignObject></svg></code></pre>
<ul>
<li data-marpit-fragment="1">Multiple packages often have duplicate dependencies in their <code>package.json</code>files.</li>
<li data-marpit-fragment="2">Lerna can reduce duplicate packages by hoisting the dependencies up to the root (topmost Lerna-project level <code>node_modules</code> directory).</li>
<li data-marpit-fragment="3">Use <code>lerna bootstrap --hoist</code> in the <code>postinstall</code> script to bootstrap the package after installing them via <code>npm install</code>.</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-footer="Monorepos - Christophe Geers" data-class="lead invert" data-theme="gaia" class="lead invert" style="--footer:Monorepos - Christophe Geers;--class:lead invert;--theme:gaia;">
<h2>Lerna with Yarn</h2>
<h2>git clone <a href="https://github.com/geersch/lerna.git">https://github.com/geersch/lerna.git</a></h2>
<p>git checkout lerna-with-yarn</p>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-marpit-fragments="6" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Lerna with Yarn</h2>
<p>Use Yarn as the NPM client.</p>
<ul>
<li data-marpit-fragment="1">
<p>Install <a href="https://yarnpkg.com">Yarn</a>.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> npm install -g yarn</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Specify Yarn as the NPM client in <code>lerna.json</code>.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;npmClient&quot;</span>: <span class="hljs-string">&quot;yarn&quot;</span>,
  <span class="hljs-attr">&quot;packages&quot;</span>: [<span class="hljs-string">&quot;packages/*&quot;</span>],
  <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;independent&quot;</span>,
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="3">
<p>Run <code>yarn import</code> to generate a <code>yarn.lock</code> from an NPM <code>package-lock.json</code> file.</p>
</li>
<li data-marpit-fragment="4">
<p>Remove the <code>node_modules</code> folder and <code>package-lock.json</code> files in the root and package folders.</p>
</li>
<li data-marpit-fragment="5">
<p>Run <code>lerna bootstrap</code> in the <code>postinstall</code> script to bootstrap the packages.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;postinstall&quot;</span>: <span class="hljs-string">&quot;lerna bootstrap&quot;</span>
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="6">
<p>Run <code>yarn</code> from the root to install the packages and bootstrap the packages.</p>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-footer="Monorepos - Christophe Geers" data-class="lead invert" data-theme="gaia" class="lead invert" style="--footer:Monorepos - Christophe Geers;--class:lead invert;--theme:gaia;">
<h2>Yarn Workspaces</h2>
<h2>git clone <a href="https://github.com/geersch/lerna.git">https://github.com/geersch/lerna.git</a></h2>
<p>git checkout yarn-workspaces</p>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-marpit-fragments="7" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Yarn Workspaces</h2>
<p>Use Yarn Workspaces for handling the dependencies.</p>
<ul>
<li data-marpit-fragment="1">
<p>Install <a href="https://yarnpkg.com">Yarn</a>.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> npm install -g yarn</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Run <code>yarn import</code> to generate a <code>yarn.lock</code> from an NPM <code>package-lock.json</code> file.</p>
</li>
<li data-marpit-fragment="3">
<p>Remove the <code>node_modules</code> folder and <code>package-lock.json</code> files in the root and package folders.</p>
</li>
<li data-marpit-fragment="4">
<p>Yarn Workspaces needs to be defined in the root <code>package.json</code>.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;workspaces&quot;</span>: [<span class="hljs-string">&quot;packages/*&quot;</span>]
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="5">
<p>Remove the <code>Lerna</code> package and the <code>lerna.json</code> configuration.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> yarn remove lerna</span>
<span class="hljs-meta">$</span><span class="bash"> rm -rf lerna.json</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="6">
<p>Remove the scripts that use Lerna in the root <code>package.json</code> file.</p>
</li>
<li data-marpit-fragment="7">
<p>Run <code>yarn</code> from the root to install the packages.</p>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-footer="Monorepos - Christophe Geers" data-class="lead invert" data-theme="gaia" class="lead invert" style="--footer:Monorepos - Christophe Geers;--class:lead invert;--theme:gaia;">
<h2>Lerna with Yarn Workspaces</h2>
<h2>git clone <a href="https://github.com/geersch/lerna.git">https://github.com/geersch/lerna.git</a></h2>
<p>git checkout lerna-with-yarn-workspaces</p>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="25" data-marpit-fragments="7" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Lerna with Yarn Workspaces</h2>
<p>Use Yarn Workspaces for handling the dependencies and use Lerna to run commands for the packages and to publish them.</p>
<ul>
<li data-marpit-fragment="1">
<p>Install <a href="https://yarnpkg.com">Yarn</a>.</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> npm install -g yarn</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Specify Yarn as the NPM client in <code>lerna.json</code> and set <code>useWorkspaces</code> to <code>true</code> to let Yarn manage the dependencies.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;npmClient&quot;</span>: <span class="hljs-string">&quot;yarn&quot;</span>,
  <span class="hljs-attr">&quot;useWorkspaces&quot;</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">&quot;packages&quot;</span>: [<span class="hljs-string">&quot;packages/*&quot;</span>],
  <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;independent&quot;</span>,
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="3">
<p>Yarn Workspaces needs to be defined in the root <code>package.json</code>.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;workspaces&quot;</span>: [<span class="hljs-string">&quot;packages/*&quot;</span>]
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="4">
<p>Run <code>yarn import</code> to generate a <code>yarn.lock</code> from an NPM <code>package-lock.json</code> file.</p>
</li>
<li data-marpit-fragment="5">
<p>Remove the <code>node_modules</code> folder and <code>package-lock.json</code> files in the root and package folders.</p>
</li>
<li data-marpit-fragment="6">
<p>Don't run <code>lerna bootstrap</code>. Remove the <code>postinstall</code> script.</p>
</li>
<li data-marpit-fragment="7">
<p>Run <code>yarn</code> from the root to install the packages.</p>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="26" data-footer="Monorepos - Christophe Geers" data-class="lead invert" data-theme="gaia" class="lead invert" style="--footer:Monorepos - Christophe Geers;--class:lead invert;--theme:gaia;">
<h2>GitHub Packages</h2>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-marpit-fragments="3" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>GitHub Packages</h2>
<p>Let's publish the packages.</p>
<ul>
<li data-marpit-fragment="1">
<p>Step 1: Set the <code>name</code> and <code>publishConfig</code> options in your package's <code>package.json</code>.</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;@geersch/calculator&quot;</span>,
  <span class="hljs-attr">&quot;publishConfig&quot;</span>: { 
    <span class="hljs-attr">&quot;registry&quot;</span>: <span class="hljs-string">&quot;https://npm.pkg.github.com/&quot;</span> 
  }
}
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="2">
<p>Step 2: Authenticate</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> yarn login --registry=https://npm.pkg.github.com/</span>
</span></span></foreignObject></svg></code></pre>
</li>
<li data-marpit-fragment="3">
<p>Step 3: Publish</p>
<pre><code class="language-shell"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-meta">$</span><span class="bash"> yarn publish</span>
</span></span></foreignObject></svg></code></pre>
</li>
</ul>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-footer="Monorepos - Christophe Geers" data-class="lead invert" data-theme="gaia" class="lead invert" style="--footer:Monorepos - Christophe Geers;--class:lead invert;--theme:gaia;">
<h2>Continuous Deployment</h2>
<footer>Monorepos - Christophe Geers</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-footer="Monorepos - Christophe Geers" data-theme="gaia" style="--footer:Monorepos - Christophe Geers;--theme:gaia;">
<h2>Pipeline</h2>
<p>An Azure DevOps pipeline.</p>
<pre><code class="language-yaml"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-attr">trigger:</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">master</span>
<span class="hljs-attr">pr:</span> <span class="hljs-string">none</span>

<span class="hljs-attr">pool:</span>
  <span class="hljs-attr">vmImage:</span> <span class="hljs-string">ubuntu-18.04</span>

<span class="hljs-attr">steps:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">script:</span> <span class="hljs-string">git</span> <span class="hljs-string">checkout</span> <span class="hljs-string">$(Build.SourceBranchName)</span>
  <span class="hljs-attr">displayName:</span> <span class="hljs-string">&#x27;Checkout $(Build.SourceBranchName)&#x27;</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">script:</span> <span class="hljs-string">|
    git remote set-url origin git@github.com:geersch/lerna.git
    git config user.name &quot;$(GIT_USERNAME)&quot;
    git config user.email &quot;$(GIT_USER_EMAIL)&quot;
</span>  <span class="hljs-attr">displayName:</span> <span class="hljs-string">&#x27;Configure GIT&#x27;</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">task:</span> <span class="hljs-string">npmAuthenticate@0</span>
  <span class="hljs-attr">inputs:</span>
    <span class="hljs-attr">workingFile:</span> <span class="hljs-string">./.npmrc</span>
    <span class="hljs-attr">customEndpoint:</span> <span class="hljs-string">&#x27;GitHub Packages&#x27;</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">script:</span> <span class="hljs-string">yarn</span>
  <span class="hljs-attr">displayName:</span> <span class="hljs-string">&#x27;Install the dependencies&#x27;</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">script:</span> <span class="hljs-string">yarn</span> <span class="hljs-string">run</span> <span class="hljs-string">publish:ci</span>
</span></span></foreignObject></svg></code></pre>
<footer>Monorepos - Christophe Geers</footer>
</section>
<script>!function(){"use strict";const t="marpitSVGPolyfill:setZoomFactor,",e=Symbol();let o,r;function n(n){const i="object"==typeof n&&n.target||document,a="object"==typeof n?n.zoom:n;window[e]||(Object.defineProperty(window,e,{configurable:!0,value:!0}),window.addEventListener("message",({data:e,origin:o})=>{if(o===window.origin)try{if(e&&"string"==typeof e&&e.startsWith(t)){const[,t]=e.split(","),o=Number.parseFloat(t);Number.isNaN(o)||(r=o)}}catch(t){console.error(t)}}));let l=!1;Array.from(i.querySelectorAll("svg[data-marpit-svg]"),t=>{var e,n,i,s;t.style.transform||(t.style.transform="translateZ(0)");const c=a||r||t.currentScale||1;o!==c&&(o=c,l=c);const d=t.getBoundingClientRect(),{length:u}=t.children;for(let o=0;o<u;o+=1){const r=t.children[o],a=r.getScreenCTM();if(a){const t=null!==(n=null===(e=r.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==n?n:0,o=null!==(s=null===(i=r.y)||void 0===i?void 0:i.baseVal.value)&&void 0!==s?s:0,l=r.firstChild,{style:u}=l;u.transformOrigin||(u.transformOrigin=`${-t}px ${-o}px`),u.transform=`scale(${c}) matrix(${a.a}, ${a.b}, ${a.c}, ${a.d}, ${a.e-d.left}, ${a.f-d.top}) translateZ(0.0001px)`}}}),!1!==l&&Array.from(i.querySelectorAll("iframe"),({contentWindow:e})=>{null==e||e.postMessage(`${t}${l}`,"null"===window.origin?"*":window.origin)})}o=1,r=void 0;const i=(t,e,o)=>{if(t.getAttribute(e)!==o)return t.setAttribute(e,o),!0};function a(t={}){const e="boolean"==typeof t?(t=>{const e=!t;return console.warn(`[DEPRECATION WARNING] Usage of observer() with boolean option has been deprecated. Please replace with the usage of option object: observer({ once: ${e?"true":"false"} }).`),{once:e}})(t):t,{once:o=!1,target:r=document}=e,a="Apple Computer, Inc."===navigator.vendor?[n]:[];let l=!o;const s=()=>{for(const t of a)t({target:r});!function(t=document){Array.from(t.querySelectorAll('svg[data-marp-fitting="svg"]'),t=>{var e;const o=t.firstChild,r=o.firstChild,{scrollWidth:n,scrollHeight:a}=r;let l,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(l=null===(e=t.parentElement)||void 0===e?void 0:e.parentElement),t.hasAttribute("data-marp-fitting-math")&&(l=t.parentElement),l){const t=getComputedStyle(l),e=Math.ceil(l.clientWidth-parseFloat(t.paddingLeft||"0")-parseFloat(t.paddingRight||"0"));e&&(s=e)}const c=Math.max(n,s),d=Math.max(a,1),u=`0 0 ${c} ${d}`;i(o,"width",""+c),i(o,"height",""+d),i(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),i(t,"viewBox",u)&&t.classList.toggle("__reflow__")})}(r),l&&window.requestAnimationFrame(s)};return s(),()=>{l=!1}}const l=Symbol(),s=document.currentScript;((t=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(t[l])return t[l];const e=a({target:t}),o=()=>{e(),delete t[l]};Object.defineProperty(t,l,{configurable:!0,value:o})})(s?s.getRootNode():document)}();
</script></foreignObject></svg></div><div class="bespoke-marp-note" data-index="4" tabindex="0"><p>A monorepo is a repository that contains multiple projects, also called workspaces or packages.
It is easier to manage than multiple repositories which each contain one project (multirepo).
Of course, this depends on the type of projects you are working on. Monorepos aren't a silver bullet
suited for every situation.

- Each package is a project on its own. 
- Every package contains its own package.json file. Each package can be versioned, built, and published independently.
- Packages can have dependency relations between ach other (e.g. package-1 &lt;- package-3).
- These inter-package dependencies are managed by symlinks.
- Lerna manages the symlinks. No need to create them manually or use npm link directly.</p></div><div class="bespoke-marp-note" data-index="6" tabindex="0"><p>Demo: demonstrate lerna init

$ npm install -g lerna
$ mkdir temp-dir &amp;&amp; cd &quot;$_&quot;
$ lerna init --independent
$ code .</p></div><div class="bespoke-marp-note" data-index="7" tabindex="0"><p>Demo: demonstrate lerna bootstrap

$ cd packages
$ mkdir packages/package-1 &amp;&amp; cd &quot;$_&quot; &amp;&amp; npm init --yes &amp;&amp; cd ../../
$ mkdir packages/package-2 &amp;&amp; cd &quot;$_&quot; &amp;&amp; npm init --yes &amp;&amp; cd ../../
$ code .

Add a dependency to package-2 from package-1.

&quot;dependencies&quot;: {
  &quot;package-2&quot;: &quot;^1.0.0&quot;
}

$ lerna bootstrap

Show symlink to package-2 in the node_modules of package-1.

Using the --hoist flag will install dependencies at the repo root. If packages depend on different versions of an external dependency, then the most commonly used version will be hoisted and a warning will be emitted. Use the --strict flag together with --hoist to throw errors if there are version conflicts.</p></div><div class="bespoke-marp-note" data-index="8" tabindex="0"><p>Demo: introduce the @geersch/lerna repository (master branch) and briefly show how it is configured.

$ git clone git@github.com:geersch/lerna.git
$ cd lerna
$ code .

Show the following files:

- lerna.json
- package.json of the logging package (chalk dependency)
- package.json of the calculator package (@geersch/logging dependency)
- package.json of repo root (postinstall script)

$ npm install

- show scripts in package.json of repo root (build, clean, format, lint...)
- show the same scripts in the package.json of the calculator and logging packages

Execute the scripts from the calculator's package folder.

$ cd packages/logging
$ npm run lint
$ npm run format
$ npm run test

Execute the same scripts from the repo root folder.

$ cd ../..
$ npm run lint
$ npm run format
$ npm run test

Demonstrate the --scope flag. 

$ npm run test -- --scope @geersch/logging

Demonstrate executing a script without the --stream flag.

Modify 'test' script in root package.json.

{ 
  &quot;test&quot;: &quot;lerna run test&quot;
}

$ npm run test</p></div><div class="bespoke-marp-note" data-index="9" tabindex="0"><p>Demo: demonstrate lerna exec

$ lerna exec --scope @geersch/logging &quot;rm -rf ./dist&quot;
$ npm run purge</p></div><div class="bespoke-marp-note" data-index="10" tabindex="0"><p>Demo: demonstrate lerna add

$ lerna add lodash
$ lerna add debug --dev
$ lerna add moment --scope @geersch/logging</p></div><div class="bespoke-marp-note" data-index="11" tabindex="0"><p>Demo: demonstrate lerna version

- Change the colors used in adavanded-console.logger.ts.
- Stage and commit the changes.

$ git commit -m &quot;fix(logging): fix colors for advanced console logger&quot;

- Update the version.

$ lerna version patch --no-git-tag-version --conventional-commits --yes

- Show updates made to the package.json and package-lock.json files.
- Show CHANGELOG.md of the logging package. Show how scopes of conventional commits are used to generate the changelogs.</p></div><div class="bespoke-marp-note" data-index="12" tabindex="0"><p>$ lerna publish from-package
// -&gt; No changes packages to publish.

Do not run the following commands, we will publish the packages near the end of the presentation.

$ npm run build
$ lerna publish
$ lerna publish patch --conventional-commits --yes</p></div><div class="bespoke-marp-note" data-index="13" tabindex="0"><p>Remove the node_modules directory from all package.

$ lerna clean

Often combined with a custom clean script for each package.

$ npm run clean</p></div><div class="bespoke-marp-note" data-index="14" tabindex="0"><p>$ lerna info</p></div><div class="bespoke-marp-note" data-index="18" tabindex="0"><p>Demo: demonstrate lerna boostrap --hoist --strict

We already setup a repository using Lerna and bootstrapped the dependencies. Let's see what the --hoist and --strict flags do.

Update postinstall script in root package.json

{
  &quot;postinstall&quot;: &quot;lerna bootstrap --hoist --strict&quot;,
}

Clean the local repo and install the dependencies again.

$ npm run clean
$ rm -rf node_modules
$ npm install
$ code.

Show that the dependencies have been hoisted:

- dependent packages are symlinked
- binaries are symlinked to individual package node_modules/.bin directories so that scripts continue to work

Using the --hoist flag will install dependencies at the repo root. If packages depend on different versions of an external dependency, then the most commonly used version will be hoisted and a warning will be emitted. Use the --strict flag together with --hoist to throw errors if there are version conflicts.

Without --strict common dependencies are still hoisted, but packages with different versions will get a normal, local node_modules installation of the necessary dependencies.</p></div><div class="bespoke-marp-note" data-index="19" tabindex="0"><p>NPM and Yarn are both package managers and rely on package.json as a container for dependency mangement.
Both use a lock file (package-lock.json or yarn.lock) to freeze dependencies and support publishing to an NPM registry.
Yarn was created for performance reasons because it took too long to install dependencies in large projects with NPM. 
Many of the gaps between NPM and Yarn have vanished over time.</p></div><div class="bespoke-marp-note" data-index="20" tabindex="0"><p>Demo: demonstrate Lerna with Yarn

Switch to the lerna-with-yarn branch and briefly go over the differences in setup.

Clean the local repo.

$ git checkout lerna-with-yarn
$ npm run clean
$ rm -rf node_modules
$ yarn

$ cd packages/logging
$ yarn lint
$ yarn format
$ yarn test

Execute the same scripts from the repo root folder.

$ cd ../..
$ yarn lint
$ yarn format
$ yarn test</p></div><div class="bespoke-marp-note" data-index="21" tabindex="0"><p>Lerna provides monorepo features with the help of NPM or Yarn as a dependency management tool. Lerna uses semantic links. 
Yarn offers support for native monorepos via Yarn Workspaces. You can configure Lerna to use Yarn Workspaces.
In that case it leaves the whole monorepo aspect solely to the natively implemented features of Yarn Workspaces.</p></div><div class="bespoke-marp-note" data-index="22" tabindex="0"><p>Demo: demonstrate Yarn Workspaces

Switch to the yarn-workspaces branch and briefly go over the differences in setup.

Clean the local repo.

$ npm run clean
$ rm -rf node_modules
$ yarn

Switch branch.

$ git checkout yarn-workspaces

$ cd packages/logging
$ yarn lint
$ yarn format
$ yarn test</p></div><div class="bespoke-marp-note" data-index="23" tabindex="0"><p>Lerna with Yarn Workspaces offers the best of two worlds. Use Yarn Workspaces to provide the monorepo functionality and let Yarn handle the dependencies. Use Lerna's commands to run commands for the multiple packages.</p></div><div class="bespoke-marp-note" data-index="24" tabindex="0"><p>Demo: demonstrate Lerna with Yarn Workspaces

Switch to the yarn-workspaces branch and briefly go over the differences in setup.

Clean the local repo.

$ git checkout lerna-with-yarn-workspaces
$ npm run clean
$ rm -rf node_modules
$ yarn
$ code .

Show that the dependencies have been hoisted by default.

$ lerna lint
$ lerna format
$ lerna test
$ lerna test --scope @geersch/logging</p></div><div class="bespoke-marp-note" data-index="26" tabindex="0"><p>Demo: demonstrate publishing the package to GitHub Packages

$ git checkout lerna-with-yarn-workspaces
$ npm run clean
$ rm -rf node_modules
$ yarn
$ yarn publish</p></div><script>!function(){"use strict";var e=function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),a=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),s={},i=function(e,t){return(t=t||{}).index=a.indexOf(e),t.slide=e,t},o=function(e,t){s[e]=(s[e]||[]).filter((function(e){return e!==t}))},l=function(e,t){return(s[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},c=function(e,t){a[e]&&(n&&l("deactivate",i(n,t)),n=a[e],l("activate",i(n,t)))},d=function(e,t){var r=a.indexOf(n)+e;l(e>0?"next":"prev",i(n,t))&&c(r,t)},u={off:o,on:function(e,t){return(s[e]||(s[e]=[])).push(t),o.bind(null,e,t)},fire:l,slide:function(e,t){if(!arguments.length)return a.indexOf(n);l("slide",i(a[e],t))&&c(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:a,destroy:function(e){l("destroy",i(n,e)),s={}}};return(t||[]).forEach((function(e){e(u)})),n||c(0),u};function t(e){e.parent.classList.add("bespoke-marp-parent"),e.slides.forEach((e=>e.classList.add("bespoke-marp-slide"))),e.on("activate",(t=>{const n=t.slide,r=!n.classList.contains("bespoke-marp-active");e.slides.forEach((e=>{e.classList.remove("bespoke-marp-active"),e.setAttribute("aria-hidden","true")})),n.classList.add("bespoke-marp-active"),n.removeAttribute("aria-hidden"),r&&(n.classList.add("bespoke-marp-active-ready"),document.body.clientHeight,n.classList.remove("bespoke-marp-active-ready"))}))}function n(e){let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map((e=>[null,...e.querySelectorAll("[data-marpit-fragment]")]))});const r=r=>void 0!==e.fragments[t][n+r],a=(r,a)=>{t=r,n=a,e.fragments.forEach(((e,t)=>{e.forEach(((e,n)=>{if(null==e)return;const s=t<r||t===r&&n<=a;e.setAttribute("data-bespoke-marp-fragment",s?"active":"inactive"),t===r&&n===a?e.setAttribute("data-bespoke-marp-current-fragment","current"):e.removeAttribute("data-bespoke-marp-current-fragment")}))})),e.fragmentIndex=a;const s={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:a};e.fire("fragment",s)};e.on("next",(({fragment:s=!0})=>{if(s){if(r(1))return a(t,n+1),!1;const s=t+1;e.fragments[s]&&a(s,0)}else{const r=e.fragments[t].length;if(n+1<r)return a(t,r-1),!1;const s=e.fragments[t+1];s&&a(t+1,s.length-1)}})),e.on("prev",(({fragment:s=!0})=>{if(r(-1)&&s)return a(t,n-1),!1;const i=t-1;e.fragments[i]&&a(i,e.fragments[i].length-1)})),e.on("slide",(({index:t,fragment:n})=>{let r=0;if(void 0!==n){const a=e.fragments[t];if(a){const{length:e}=a;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}a(t,r)})),a(0,0)}var r,a,s=(function(e){
/*!
* screenfull
* v5.0.2 - 2020-02-13
* (c) Sindre Sorhus; MIT License
*/
!function(){var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,a=n.length,s={};r<a;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)s[n[0][r]]=e[r];return s}return!1}(),a={change:r.fullscreenchange,error:r.fullscreenerror},s={request:function(e){return new Promise(function(n,a){var s=function(){this.off("change",s),n()}.bind(this);this.on("change",s);var i=(e=e||t.documentElement)[r.requestFullscreen]();i instanceof Promise&&i.then(s).catch(a)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var a=function(){this.off("change",a),e()}.bind(this);this.on("change",a);var s=t[r.exitFullscreen]();s instanceof Promise&&s.then(a).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=a[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=a[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=s:window.screenfull=s):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}(a={path:r,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports);function i(e){e.fullscreen=()=>{s.isEnabled&&s.toggle(document.body)},document.addEventListener("keydown",(t=>{70!==t.which&&122!==t.which||t.altKey||t.ctrlKey||t.metaKey||!s.isEnabled||(e.fullscreen(),t.preventDefault())}))}function o(e=2e3){return t=>{let n;function r(){n&&clearTimeout(n),n=setTimeout((()=>{t.parent.classList.add("bespoke-marp-inactive"),t.fire("marp-inactive")}),e),t.parent.classList.contains("bespoke-marp-inactive")&&(t.parent.classList.remove("bespoke-marp-inactive"),t.fire("marp-active"))}document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("touchend",r),setTimeout(r,0)}}const l=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"];function c(e){e.parent.addEventListener("keydown",(e=>{if(!e.target)return;const t=e.target;(l.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()}))}function d(e){window.addEventListener("load",(()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute("data-bespoke-marp-load",e)}}))}var u;function f({interval:e=200}={}){return t=>{document.addEventListener("keydown",(e=>{if(32===e.which&&e.shiftKey)t.prev();else if(33===e.which||37===e.which||38===e.which)t.prev({fragment:!e.shiftKey});else if(32!==e.which||e.shiftKey)if(34===e.which||39===e.which||40===e.which)t.next({fragment:!e.shiftKey});else if(35===e.which)t.slide(t.slides.length-1,{fragment:-1});else{if(36!==e.which)return;t.slide(0)}else t.next();e.preventDefault()}));let n,r,a=0;t.parent.addEventListener("wheel",(s=>{let i=!1;const o=(e,t)=>{e&&(i=i||function(e,t){return function(e,t){const n=t===u.X?"Width":"Height";return e["client"+n]<e["scroll"+n]}(e,t)&&function(e,t){const{overflow:n}=e,r=e["overflow"+t];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r}(getComputedStyle(e),t)}(e,t)),(null==e?void 0:e.parentElement)&&o(e.parentElement,t)};if(0!==s.deltaX&&o(s.target,u.X),0!==s.deltaY&&o(s.target,u.Y),i)return;s.preventDefault(),r&&clearTimeout(r),r=setTimeout((()=>{n=0}),e);const l=Date.now()-a<e,c=Math.sqrt(Math.pow(s.deltaX,2)+Math.pow(s.deltaY,2)),d=c<=n;if(n=c,l||d)return;let f;(s.deltaX>0||s.deltaY>0)&&(f="next"),(s.deltaX<0||s.deltaY<0)&&(f="prev"),f&&(t[f](),a=Date.now())}))}}!function(e){e.X="X",e.Y="Y"}(u||(u={}));const m=(...e)=>history.replaceState(...e),p="data-bespoke-view";var h;!function(e){e.Normal="",e.Presenter="presenter",e.Next="next"}(h||(h={}));const g=(e,{protocol:t,host:n,pathname:r,hash:a}=location)=>{const s=e.toString();return`${t}//${n}${r}${s?"?":""}${s}${a}`},v=()=>{switch(document.body.getAttribute(p)){case h.Normal:return h.Normal;case h.Presenter:return h.Presenter;case h.Next:return h.Next;default:throw new Error("View mode is not assigned.")}},b=e=>new URLSearchParams(location.search).get(e),w=(e,t={})=>{const n=Object.assign({location:location,setter:m},t),r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter(null,document.title,g(r,n.location))}catch(e){console.error(e)}},y={available:(()=>{try{return localStorage.setItem("bespoke-marp","bespoke-marp"),localStorage.removeItem("bespoke-marp"),!0}catch(e){return console.warn("Warning: Using localStorage is restricted in the current host so some features may not work."),!1}})(),get:e=>{try{return localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}}};function x(e=".bespoke-marp-osc"){const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[data-bespoke-marp-osc=${JSON.stringify(e)}]`).forEach(n)};return s.isEnabled||n("fullscreen",(e=>e.style.display="none")),y.available||n("presenter",(e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."})),e=>{t.addEventListener("click",(t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;switch(n&&t.target.blur(),n){case"next":e.next({fragment:!t.shiftKey});break;case"prev":e.prev({fragment:!t.shiftKey});break;case"fullscreen":"function"==typeof e.fullscreen&&s.isEnabled&&e.fullscreen();break;case"presenter":e.openPresenterView()}}})),e.parent.appendChild(t),e.on("activate",(({index:t})=>{n("page",(n=>n.textContent=`Page ${t+1} of ${e.slides.length}`))})),e.on("fragment",(({index:t,fragments:r,fragmentIndex:a})=>{n("prev",(e=>e.disabled=0===t&&0===a)),n("next",(n=>n.disabled=t===e.slides.length-1&&a===r.length-1))})),e.on("marp-active",(()=>t.removeAttribute("aria-hidden"))),e.on("marp-inactive",(()=>t.setAttribute("aria-hidden","true"))),s.isEnabled&&s.onchange((()=>n("fullscreen",(e=>e.classList.toggle("exit",s.isEnabled&&s.isFullscreen)))))}}function E(){const e=Math.max(Math.floor(.85*window.innerWidth),640),t=Math.max(Math.floor(.85*window.innerHeight),360);return window.open(this.presenterUrl,"bespoke-marp-presenter-"+this.syncKey,`width=${e},height=${t},menubar=no,toolbar=no`)}function k(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),g(e)}var L=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let S=e=>String(e).replace(/[&<>"']/g,(e=>`&${I[e]};`)),I={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},P="dangerouslySetInnerHTML",M={className:"class",htmlFor:"for"},N={};function F(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==P&&(r+=` ${M[e]?M[e]:S(e)}="${S(t[e])}"`);r+=">"}if(-1===L.indexOf(e)){if(t[P])r+=t[P].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===N[e]?e:S(e)}r+=e?`</${e}>`:""}return N[r]=!0,r}const O=({children:e})=>F(null,null,...e),q="bespoke-marp-presenter-container",C="bespoke-marp-presenter-next",T="bespoke-marp-presenter-next-container",A="bespoke-marp-presenter-note-container",K="bespoke-marp-presenter-info-container",$="bespoke-marp-presenter-info-page",j="bespoke-marp-presenter-info-page-text",D="bespoke-marp-presenter-info-page-prev",R="bespoke-marp-presenter-info-page-next",U="bespoke-marp-presenter-info-time",V="bespoke-marp-presenter-info-timer";function X(e){const{title:t}=document;document.title="[Presenter view]"+(t?" - "+t:"");const n={},r=e=>(n[e]=n[e]||document.querySelector("."+e),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=q,t.appendChild(e),t.insertAdjacentHTML("beforeend",F(O,null,F("div",{class:T},F("iframe",{class:C,src:"?view=next"})),F("div",{class:A}),F("div",{class:K},F("div",{class:$},F("button",{class:D,tabindex:"-1",title:"Previous"},"Previous"),F("span",{class:j}),F("button",{class:R,tabindex:"-1",title:"Next"},"Next")),F("time",{class:U,title:"Current time"}),F("div",{class:V})))),t})(e.parent)),(e=>{r(T).addEventListener("click",(()=>e.next()));const t=r(C),n=(a=t,(e,t)=>{var n;return null===(n=a.contentWindow)||void 0===n?void 0:n.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin)});var a;t.addEventListener("load",(()=>{r(T).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",(({index:e,fragmentIndex:t})=>n(e,t)))}));const s=document.querySelectorAll(".bespoke-marp-note");s.forEach((e=>{e.addEventListener("keydown",(e=>e.stopPropagation())),r(A).appendChild(e)})),e.on("activate",(()=>s.forEach((t=>t.classList.toggle("active",t.dataset.index==e.slide()))))),e.on("activate",(({index:t})=>{r(j).textContent=`${t+1} / ${e.slides.length}`}));const i=r(D),o=r(R);i.addEventListener("click",(t=>{i.blur(),e.prev({fragment:!t.shiftKey})})),o.addEventListener("click",(t=>{o.blur(),e.next({fragment:!t.shiftKey})})),e.on("fragment",(({index:t,fragments:n,fragmentIndex:r})=>{i.disabled=0===t&&0===r,o.disabled=t===e.slides.length-1&&r===n.length-1}));const l=()=>r(U).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)}function Y(e){const t=v();return t===h.Next&&e.appendChild(document.createElement("span")),e=>{t===h.Normal&&function(e){if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:E},presenterUrl:{enumerable:!0,get:k}}),y.available&&document.addEventListener("keydown",(t=>{80!==t.which||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())}))}(e),t===h.Presenter&&X(e),t===h.Next&&function(e){const t=t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let a=Number.parseInt(t,10),s=Number.parseInt(n,10)+1;s>=e.fragments[a].length&&(a+=1,s=0),e.slide(a,{fragment:s})}};window.addEventListener("message",t),e.on("destroy",(()=>window.removeEventListener("message",t)))}(e)}}function B(e){e.on("activate",(t=>{document.querySelectorAll(".bespoke-progress-bar").forEach((n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"}))}))}const z=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t};function H(e={}){const t=Object.assign({history:!0},e);return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},a=(t={fragment:!0})=>{((t,n)=>{const{fragments:r,slides:a}=e,s=Math.max(0,Math.min(t,a.length-1)),i=Math.max(0,Math.min(n||0,r[s].length-1));s===e.slide()&&i===e.fragmentIndex||e.slide(s,{fragment:i})})((z(location.hash.slice(1))||1)-1,t.fragment?z(b("f")||""):null)};e.on("fragment",(({index:e,fragmentIndex:r})=>{n||w({f:0===r||r.toString()},{location:Object.assign(Object.assign({},location),{hash:"#"+(e+1)}),setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})})),setTimeout((()=>{a(),window.addEventListener("hashchange",(()=>r((()=>{a({fragment:!1}),w({f:void 0})})))),window.addEventListener("popstate",(()=>{n||r((()=>a()))})),n=!1}),0)}}function W(e={}){const t=e.key||((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t})(),n="bespoke-marp-sync-"+t,r=()=>{const e=y.get(n);return e?JSON.parse(e):Object.create(null)},a=e=>{const t=r(),a=Object.assign(Object.assign({},t),e(t));return y.set(n,JSON.stringify(a)),a};return a((e=>({reference:(e.reference||0)+1}))),e=>{Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let s=!0;setTimeout((()=>{e.on("fragment",(e=>{s&&a((()=>({index:e.index,fragmentIndex:e.fragmentIndex})))}))}),0),window.addEventListener("storage",(t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),r=JSON.parse(t.newValue);if(n.index!==r.index||n.fragmentIndex!==r.fragmentIndex)try{s=!1,e.slide(r.index,{fragment:r.fragmentIndex})}finally{s=!0}}})),e.on("destroy",(()=>{const{reference:e}=r();void 0===e||e<=1?y.remove(n):a((()=>({reference:e-1})))}))}}function J({slope:e=Math.tan(-35*Math.PI/180),swipeThreshold:t=30}={}){return n=>{let r;const a=n.parent,s=e=>{const t=a.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};a.addEventListener("touchstart",(e=>{r=1===e.touches.length?s(e.touches[0]):void 0}),{passive:!0}),a.addEventListener("touchmove",(e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=s(e.touches[0]),n=t.x-r.x,a=t.y-r.y;r.delta=Math.sqrt(Math.pow(Math.abs(n),2)+Math.pow(Math.abs(a),2)),r.radian=Math.atan2(n,a)}else r=void 0})),a.addEventListener("touchend",(a=>{if(r){if(r.delta&&r.delta>=t&&r.radian){let t=r.radian-e;t=(t+Math.PI)%(2*Math.PI)-Math.PI,n[t<0?"next":"prev"](),a.stopPropagation()}r=void 0}}),{passive:!0})}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function _(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))}let G=void 0;const Q=()=>(void 0===G&&(G="wakeLock"in navigator&&navigator.wakeLock),G),Z=()=>_(void 0,void 0,void 0,(function*(){const e=Q();if(e)try{const t=yield e.request("screen");return t.addEventListener("release",(()=>{console.debug("[Marp CLI] Wake Lock was released")})),console.debug("[Marp CLI] Wake Lock is active"),t}catch(e){console.warn(e)}return null}));function ee(){return _(this,void 0,void 0,(function*(){if(!Q())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&Z()};return document.addEventListener("visibilitychange",t),document.addEventListener("fullscreenchange",t),e=yield Z(),e}))}const te=[h.Normal,h.Presenter,h.Next];!function(r=document.getElementById("p")){document.body.setAttribute(p,(()=>{switch(b("view")){case"next":return h.Next;case"presenter":return h.Presenter;default:return h.Normal}})());const a=(e=>{const t=b(e);return w({[e]:void 0}),t})("sync")||void 0,s=!1,l=!0,u=e(r,((...e)=>{const t=te.findIndex((e=>v()===e));if(t<0)throw new Error("Invalid view");return e.map((([e,n])=>e[t]&&n)).filter((e=>e))})([[l,l,s],W({key:a})],[[l,l,l],Y(r)],[[l,l,s],c],[[l,l,l],t],[[l,s,s],o()],[[l,l,l],d],[[l,l,l],H({history:!1})],[[l,l,s],f()],[[l,l,s],i],[[l,s,s],B],[[l,l,s],J()],[[l,s,s],x()],[[l,l,l],n],[[l,l,s],ee]));window.addEventListener("beforeunload",(()=>w({sync:u.syncKey}))),window.addEventListener("unload",(()=>u.destroy()))}()}();</script></body></html>